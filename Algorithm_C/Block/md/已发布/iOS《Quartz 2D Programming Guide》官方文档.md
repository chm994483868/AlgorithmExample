# iOSã€ŠQuartz 2D Programming Guideã€‹å®˜æ–¹æ–‡æ¡£

## Introduction
&emsp;Core Graphicsï¼Œä¹Ÿè¢«ç§°ä¸º Quartz 2Dï¼Œæ˜¯ä¸€ä¸ªå…ˆè¿›çš„äºŒç»´ç»˜å›¾å¼•æ“ï¼Œå¯ç”¨äº iOSã€tvOS å’Œ macOS åº”ç”¨ç¨‹åºå¼€å‘ã€‚Quartz 2D æä¾›ä½çº§åˆ«ã€è½»é‡çº§çš„ 2D æ¸²æŸ“ï¼Œæ— è®ºæ˜¾ç¤ºæˆ–æ‰“å°è®¾å¤‡å¦‚ä½•ï¼Œéƒ½å…·æœ‰æ— ä¸ä¼¦æ¯”çš„è¾“å‡ºä¿çœŸåº¦ã€‚Quartz 2D æ˜¯åˆ†è¾¨ç‡å’Œè®¾å¤‡æ— å…³ã€‚

&emsp;Quartz 2D API æ˜“äºä½¿ç”¨ï¼Œå¹¶æä¾›å¯¹å¼ºå¤§åŠŸèƒ½çš„ä½¿ç”¨ï¼Œå¦‚é€æ˜å±‚ï¼ˆtransparency layersï¼‰ã€åŸºäºè·¯å¾„çš„ç»˜å›¾ï¼ˆpath-based drawingï¼‰ã€ç¦»å±æ¸²æŸ“ï¼ˆoffscreen renderingï¼‰ã€é«˜çº§é¢œè‰²ç®¡ç†ï¼ˆadvanced color managementï¼‰ã€æŠ—é”¯é½¿æ¸²æŸ“ï¼ˆanti-aliased renderingï¼‰ä»¥åŠ PDF æ–‡æ¡£åˆ›å»ºï¼ˆcreationï¼‰ã€æ˜¾ç¤ºï¼ˆdisplayï¼‰å’Œè§£æï¼ˆparsingï¼‰ã€‚

### Who Should Read This Document?
&emsp;æœ¬æ–‡æ¡£é€‚ç”¨äºéœ€è¦æ‰§è¡Œä»¥ä¸‹ä»»ä½•ä»»åŠ¡çš„å¼€å‘äººå‘˜ï¼š

+ Draw graphicsï¼ˆç»˜åˆ¶å›¾å½¢ï¼‰
+ Provide graphics editing capabilities in an applicationï¼ˆåœ¨åº”ç”¨ç¨‹åºä¸­æä¾›å›¾å½¢ç¼–è¾‘åŠŸèƒ½ï¼‰
+ Create or display bitmap imagesï¼ˆåˆ›å»ºæˆ–æ˜¾ç¤ºä½å›¾å›¾åƒï¼‰
+ Work with PDF documentsï¼ˆå¤„ç† PDF æ–‡æ¡£ï¼‰

### Organization of This Documentï¼ˆæœ¬æ–‡æ¡£çš„ç»„ç»‡ç»“æ„ï¼‰
&emsp;æœ¬æ–‡æ¡£åˆ†ä¸ºä»¥ä¸‹ç« èŠ‚ï¼š

+ Quartz 2D Overview æè¿°äº†é¡µé¢ã€ç»˜å›¾ç›®æ ‡ã€Quartz ä¸é€æ˜æ•°æ®ç±»å‹ã€å›¾å½¢çŠ¶æ€ã€åæ ‡å’Œå†…å­˜ç®¡ç†ï¼Œå¹¶ä»‹ç»äº† Quartz å¦‚ä½• â€œunder the hoodâ€ å·¥ä½œï¼ˆå¦‚ä½•åœ¨å¼•æ“ä¸‹å·¥ä½œï¼‰ã€‚
+ Graphics Contexts æè¿°äº†å„ç§ç»˜å›¾ç›®æ ‡ï¼Œå¹¶æä¾›äº†åˆ›å»ºå„ç§å›¾å½¢ä¸Šä¸‹æ–‡çš„åˆ†æ­¥è¯´æ˜ã€‚
+ Paths è®¨è®ºæ„æˆè·¯å¾„çš„åŸºæœ¬å…ƒç´ ï¼Œæ¼”ç¤ºå¦‚ä½•åˆ›å»ºå’Œç»˜åˆ¶è·¯å¾„ï¼Œæ¼”ç¤ºå¦‚ä½•è®¾ç½®å‰ªè£åŒºåŸŸï¼Œå¹¶è§£é‡Šæ··åˆæ¨¡å¼å¦‚ä½•å½±å“ç»˜åˆ¶ã€‚
+ Color and Color Spaces è®¨è®ºé¢œè‰²å€¼å’Œé€æ˜åº¦çš„ alpha å€¼ï¼Œå¹¶æè¿°å¦‚ä½•åˆ›å»ºé¢œè‰²ç©ºé—´ã€è®¾ç½®é¢œè‰²ã€åˆ›å»ºé¢œè‰²å¯¹è±¡å’Œè®¾ç½®æ¸²æŸ“æ„å›¾ã€‚
+ Transforms æè¿°å½“å‰å˜æ¢çŸ©é˜µå¹¶è¯´æ˜å¦‚ä½•ä¿®æ”¹å®ƒï¼Œè¯´æ˜å¦‚ä½•è®¾ç½®ä»¿å°„å˜æ¢ï¼Œè¯´æ˜å¦‚ä½•åœ¨ç”¨æˆ·å’Œè®¾å¤‡ç©ºé—´ä¹‹é—´è¿›è¡Œè½¬æ¢ï¼Œå¹¶æä¾›æœ‰å…³ Quartz æ‰§è¡Œçš„æ•°å­¦è¿ç®—çš„èƒŒæ™¯ä¿¡æ¯ã€‚
+ Patterns å®šä¹‰äº†ä¸€ä¸ªæ¨¡å¼åŠå…¶éƒ¨åˆ†ï¼Œå‘Šè¯‰ Quartz å¦‚ä½•æ¸²æŸ“å®ƒä»¬ï¼Œå¹¶å±•ç¤ºäº†å¦‚ä½•åˆ›å»ºå½©è‰²å’Œæ¨¡ç‰ˆæ¨¡å¼ã€‚
+ Shadows æè¿°äº†ä»€ä¹ˆæ˜¯é˜´å½±ï¼Œè§£é‡Šäº†å®ƒä»¬æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå¹¶æ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨å®ƒä»¬è¿›è¡Œç»˜åˆ¶ã€‚
+ Gradients è®¨è®ºè½´å‘å’Œå¾„å‘æ¸å˜ï¼Œå¹¶æ¼”ç¤ºå¦‚ä½•åˆ›å»ºå’Œä½¿ç”¨ CGShading å’Œ CGGradient å¯¹è±¡ã€‚
+ Transparency Layers ç»™å‡ºäº†é€æ˜å±‚çš„å¤–è§‚ç¤ºä¾‹ï¼Œè®¨è®ºäº†å®ƒä»¬çš„å·¥ä½œæ–¹å¼ï¼Œå¹¶æä¾›äº†å®ç°å®ƒä»¬çš„é€æ­¥è¯´æ˜ã€‚
+ Data Management in Quartz 2D è®¨è®ºäº†å¦‚ä½•å°†æ•°æ®ç§»å…¥å’Œç§»å‡º Quartzã€‚
+ Bitmap Images and Image Masks æè¿°äº†æ„æˆä½å›¾å›¾åƒå®šä¹‰çš„å†…å®¹ï¼Œå¹¶æ¼”ç¤ºäº†å¦‚ä½•å°†ä½å›¾å›¾åƒç”¨ä½œ Quartz ç»˜å›¾åŸè¯­ï¼ˆprimitiveï¼‰ã€‚å®ƒè¿˜æè¿°äº†å¯ä»¥åœ¨å›¾åƒä¸Šä½¿ç”¨çš„é®ç½©æŠ€æœ¯ï¼Œå¹¶æ˜¾ç¤ºäº†åœ¨ç»˜åˆ¶å›¾åƒæ—¶ä½¿ç”¨æ··åˆæ¨¡å¼å¯ä»¥å®ç°çš„å„ç§æ•ˆæœã€‚
+ Core Graphics Layer Drawing æè¿°äº†å¦‚ä½•åˆ›å»ºå’Œä½¿ç”¨ drawing layers æ¥å®ç°é«˜æ€§èƒ½çš„å›¾å½¢åŒ–ç»˜åˆ¶æˆ–åœ¨å±å¹•å¤–ç»˜åˆ¶ï¼ˆto draw offscreenï¼‰ã€‚
+ PDF Document Creation, Viewing, and Transforming æ¼”ç¤ºå¦‚ä½•æ‰“å¼€å’ŒæŸ¥çœ‹ PDF æ–‡æ¡£ã€å¯¹å…¶åº”ç”¨è½¬æ¢ã€åˆ›å»º PDF æ–‡ä»¶ã€è®¿é—® PDF å…ƒæ•°æ®ã€æ·»åŠ é“¾æ¥ä»¥åŠæ·»åŠ å®‰å…¨åŠŸèƒ½ï¼ˆå¦‚å¯†ç ä¿æŠ¤ï¼‰ã€‚
+ PDF Document Parsing æè¿°äº†å¦‚ä½•ä½¿ç”¨ CGPDFScanner å’Œ CGPDFContentStream å¯¹è±¡æ¥è§£æå’Œæ£€æŸ¥ PDF æ–‡æ¡£ã€‚
+ PostScript Conversion æ¦‚è¿°äº†å¯åœ¨ Mac OS X ä¸­ç”¨äºå°† PostScript æ–‡ä»¶è½¬æ¢ä¸º PDF æ–‡æ¡£çš„å‡½æ•°ã€‚è¿™äº›åŠŸèƒ½åœ¨ iOS ä¸­ä¸å¯ç”¨ã€‚
+ Text æè¿°äº† Quartz 2D å¯¹æ–‡æœ¬å’Œ glyph çš„ä½çº§æ”¯æŒï¼Œä»¥åŠæä¾›é«˜çº§å’Œ Unicode æ–‡æœ¬æ”¯æŒçš„æ›¿ä»£æ–¹æ¡ˆã€‚æœ¬æ–‡è¿˜è®¨è®ºäº†å¦‚ä½•å¤åˆ¶å­—ä½“å˜ä½“ã€‚
+ Glossary å®šä¹‰äº†æœ¬æŒ‡å—ä¸­ä½¿ç”¨çš„æœ¯è¯­ã€‚

### See Also
&emsp;ä»¥ä¸‹æ˜¯ä½¿ç”¨ Quartz 2D çš„æ‰€æœ‰äººçš„å¿…å¤‡é˜…è¯»èµ„æ–™ï¼š
+ [Core Graphics Framework Reference](https://developer.apple.com/documentation/coregraphics) æä¾›äº†ä¸€ä¸ªå®Œæ•´çš„å‚è€ƒ Quartz 2D åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ã€‚
+ [Color Management Overview](https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/csintro/csintro_intro/csintro_intro.html#//apple_ref/doc/uid/TP30001148) æ˜¯å¯¹è‰²å½©æ„ŸçŸ¥åŸç†ã€è‰²å½©ç©ºé—´å’Œè‰²å½©ç®¡ç†ç³»ç»Ÿçš„ç®€è¦ä»‹ç»ã€‚
+ Mailing listsã€‚åŠ å…¥ [quartz-dev](https://lists.apple.com) mailing listï¼Œè®¨è®ºä½¿ç”¨ Quartz 2D çš„é—®é¢˜ã€‚

## Overview of Quartz 2Dï¼ˆQuartz 2D æ¦‚è¿°ï¼‰
&emsp;Quartz 2D æ˜¯ä¸€ä¸ªäºŒç»´ç»˜å›¾å¼•æ“ï¼Œå¯ä»¥åœ¨ iOS ç¯å¢ƒä¸­è®¿é—®ï¼Œä¹Ÿå¯ä»¥ä»å†…æ ¸ä¹‹å¤–çš„æ‰€æœ‰ Mac OS X åº”ç”¨ç¨‹åºç¯å¢ƒè®¿é—®ã€‚ä½ å¯ä»¥ä½¿ç”¨ Quartz 2D åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼ˆAPIï¼‰è®¿é—®åŠŸèƒ½ï¼Œå¦‚åŸºäºè·¯å¾„çš„ç»˜å›¾ï¼ˆpath-based drawingï¼‰ã€é€æ˜ç»˜åˆ¶ï¼ˆpainting with transparencyï¼‰ã€ç€è‰²ï¼ˆshadingï¼‰ã€å›¾å½¢é˜´å½±ï¼ˆdrawing shadowsï¼‰ã€é€æ˜å±‚ï¼ˆtransparency layersï¼‰ã€é¢œè‰²ç®¡ç†ï¼ˆcolor managementï¼‰ã€æŠ—é”¯é½¿æ¸²æŸ“ï¼ˆanti-aliased renderingï¼‰ã€PDF æ–‡æ¡£ç”Ÿæˆå’Œ PDF å…ƒæ•°æ®è®¿é—®ã€‚åªè¦æœ‰å¯èƒ½ï¼ŒQuartz 2D å°±ä¼šåˆ©ç”¨å›¾å½¢ç¡¬ä»¶çš„å¼ºå¤§åŠŸèƒ½ã€‚

&emsp;åœ¨ MacOS X ä¸­ï¼ŒQuartz 2D å¯ä»¥ä¸æ‰€æœ‰å…¶ä»–å›¾å½¢å’ŒæˆåƒæŠ€æœ¯â€”Core Imageã€Core Videoã€OpenGL å’Œ QuickTime â€”é…åˆä½¿ç”¨ã€‚å¯ä»¥ä½¿ç”¨ QuickTime å‡½æ•° GraphicsImportCreateCGImage ä» QuickTime å›¾å½¢å¯¼å…¥å™¨åœ¨ Quartz ä¸­åˆ›å»ºå›¾åƒã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§ QuickTime æ¡†æ¶å‚è€ƒã€‚åœ¨ Mac OS X ä¸­ï¼Œåœ¨ Quartz 2D å’Œ Core Image ä¹‹é—´ç§»åŠ¨æ•°æ®ï¼ˆMoving Data Between Quartz 2D and Core Image in Mac OS Xï¼‰æè¿°äº†å¦‚ä½•å‘ Core Image æä¾›å›¾åƒï¼ŒCore Image æ˜¯ä¸€ä¸ªæ”¯æŒå›¾åƒå¤„ç†çš„æ¡†æ¶ã€‚

&emsp;ç±»ä¼¼åœ°ï¼Œåœ¨ iOS ä¸­ï¼ŒQuartz 2D ä½¿ç”¨æ‰€æœ‰å¯ç”¨çš„å›¾å½¢å’ŒåŠ¨ç”»æŠ€æœ¯ï¼Œå¦‚ Core Animationã€OpenGL ES å’Œ UIKit ç±»ã€‚

### The Page
&emsp;Quartz 2D ä½¿ç”¨ painter çš„æ¨¡å‹è¿›è¡Œæˆåƒã€‚åœ¨ painter çš„æ¨¡å‹ä¸­ï¼Œæ¯ä¸ªè¿ç»­çš„ç»˜å›¾æ“ä½œéƒ½ä¼šå¯¹è¾“å‡º "canvas"ï¼ˆé€šå¸¸ç§°ä¸º pageï¼‰åº”ç”¨ä¸€å±‚ "paint"ã€‚å¯ä»¥é€šè¿‡é™„åŠ çš„ç»˜å›¾æ“ä½œè¦†ç›–æ›´å¤šçš„ç»˜å›¾æ¥ä¿®æ”¹ page ä¸Šçš„ç»˜å›¾ã€‚ä¸èƒ½ä¿®æ”¹ page ä¸Šç»˜åˆ¶çš„å¯¹è±¡ï¼Œé™¤éè¦†ç›–æ›´å¤šçš„ç»˜åˆ¶ã€‚æ­¤æ¨¡å‹å…è®¸ä½ ä»å°‘é‡å¼ºå¤§çš„åŸè¯­æ„å»ºæå…¶å¤æ‚çš„å›¾åƒã€‚

&emsp;å›¾ 1-1 æ˜¾ç¤ºäº† painter æ¨¡å‹çš„å·¥ä½œåŸç†ã€‚ä¸ºäº†è·å¾—å›¾å½¢é¡¶éƒ¨çš„å›¾åƒï¼Œé¦–å…ˆç»˜åˆ¶å·¦ä¾§çš„å½¢çŠ¶ï¼Œç„¶åç»˜åˆ¶å®ä½“å½¢çŠ¶ã€‚å®å¿ƒå½¢çŠ¶è¦†ç›–ç¬¬ä¸€ä¸ªå½¢çŠ¶ï¼Œé™¤äº†ç¬¬ä¸€ä¸ªå½¢çŠ¶çš„å‘¨é•¿å¤–ï¼Œå…¶ä»–å½¢çŠ¶éƒ½è¢«é®æŒ¡ã€‚å›¾ 1-1 åº•éƒ¨æŒ‰ç›¸åé¡ºåºç»˜åˆ¶å›¾å½¢ï¼Œé¦–å…ˆç»˜åˆ¶å®ä½“å›¾å½¢ã€‚æ­£å¦‚ä½ æ‰€è§ï¼Œåœ¨ painter çš„æ¨¡å‹ä¸­ï¼Œç»˜ç”»é¡ºåºå¾ˆé‡è¦ã€‚

![painters_model](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b5473fac8a0043799e793bfb04450a6c~tplv-k3u1fbpfcp-watermark.image)

&emsp;page å¯ä»¥æ˜¯ä¸€å¼ çœŸæ­£çš„çº¸ï¼ˆå¦‚æœè¾“å‡ºè®¾å¤‡æ˜¯æ‰“å°æœºï¼‰ï¼›ä¹Ÿå¯ä»¥æ˜¯ä¸€å¼ è™šæ‹Ÿçš„çº¸ï¼ˆå¦‚æœè¾“å‡ºè®¾å¤‡æ˜¯ PDF æ–‡ä»¶ï¼‰ï¼›ç”šè‡³å¯ä»¥æ˜¯ä½å›¾å›¾åƒã€‚page çš„ç¡®åˆ‡æ€§è´¨å–å†³äºä½ ä½¿ç”¨çš„ç‰¹å®šå›¾å½¢ä¸Šä¸‹æ–‡ã€‚

### Drawing Destinations: The Graphics Context
&emsp;å›¾å½¢ä¸Šä¸‹æ–‡æ˜¯ä¸€ç§ä¸é€æ˜çš„æ•°æ®ç±»å‹ï¼ˆCGContextRefï¼‰ï¼Œå®ƒå°è£…äº† Quartz ç”¨äºå°†å›¾åƒç»˜åˆ¶åˆ°è¾“å‡ºè®¾å¤‡ï¼ˆå¦‚ PDF æ–‡ä»¶ã€ä½å›¾æˆ–æ˜¾ç¤ºå™¨ä¸Šçš„çª—å£ï¼‰çš„ä¿¡æ¯ã€‚å›¾å½¢ä¸Šä¸‹æ–‡ä¸­çš„ä¿¡æ¯åŒ…æ‹¬å›¾å½¢ç»˜å›¾å‚æ•°å’Œ page ä¸Šçš„ç‰¹å®šäºè®¾å¤‡çš„ç»˜ç”»è¡¨ç¤ºã€‚Quartz ä¸­çš„æ‰€æœ‰å¯¹è±¡éƒ½è¢«ç»˜åˆ¶åˆ°æˆ–åŒ…å«åœ¨å›¾å½¢ä¸Šä¸‹æ–‡ä¸­ã€‚

&emsp;å¯ä»¥å°†å›¾å½¢ä¸Šä¸‹æ–‡è§†ä¸ºç»˜å›¾ç›®æ ‡ï¼Œå¦‚å›¾ 1-2 æ‰€ç¤ºã€‚ä½¿ç”¨ Quartz ç»˜åˆ¶æ—¶ï¼Œæ‰€æœ‰è®¾å¤‡ç‰¹å®šçš„ç‰¹å¾éƒ½åŒ…å«åœ¨æ‰€ä½¿ç”¨çš„ç‰¹å®šç±»å‹çš„å›¾å½¢ä¸Šä¸‹æ–‡ä¸­ã€‚æ¢è¨€ä¹‹ï¼Œä½ åªéœ€ä¸ºåŒä¸€åºåˆ—çš„ Quartz ç»˜å›¾ä¾‹ç¨‹æä¾›ä¸åŒçš„å›¾å½¢ä¸Šä¸‹æ–‡ï¼Œå°±å¯ä»¥å°†ç›¸åŒçš„å›¾åƒç»˜åˆ¶åˆ°ä¸åŒçš„è®¾å¤‡ä¸Šã€‚ä½ ä¸éœ€è¦æ‰§è¡Œä»»ä½•ç‰¹å®šäºè®¾å¤‡çš„è®¡ç®—ï¼›Quartz ä¼šä¸ºä½ æ‰§è¡Œã€‚

&emsp;Figure 1-2  Quartz drawing destinations

![draw_destinations](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/0b76c444cb854fda9aa3e221e00bff86~tplv-k3u1fbpfcp-watermark.image)

&emsp;è¿™äº›å›¾å½¢ä¸Šä¸‹æ–‡å¯ç”¨äºä½ çš„åº”ç”¨ç¨‹åºï¼š
+ ï¼ˆbitmap graphics contextï¼‰ä½å›¾å›¾å½¢ä¸Šä¸‹æ–‡å…è®¸ä½ åœ¨ä½å›¾ä¸­ç»˜åˆ¶ RGB é¢œè‰²ã€CMYK é¢œè‰²æˆ–ç°åº¦ã€‚ä½å›¾æ˜¯åƒç´ çš„çŸ©å½¢é˜µåˆ—ï¼ˆæˆ–å…‰æ …ï¼‰ï¼Œæ¯ä¸ªåƒç´ ä»£è¡¨å›¾åƒä¸­çš„ä¸€ä¸ªç‚¹ã€‚ä½å›¾å›¾åƒï¼ˆBitmap imagesï¼‰ä¹Ÿç§°ä¸ºé‡‡æ ·å›¾åƒï¼ˆsampled imagesï¼‰ã€‚è¯·å‚è§ Creating a Bitmap Graphics Contextã€‚

+ ï¼ˆPDF graphics contextï¼‰PDF å›¾å½¢ä¸Šä¸‹æ–‡å…è®¸ä½ åˆ›å»º PDF æ–‡ä»¶ã€‚åœ¨ PDF æ–‡ä»¶ä¸­ï¼Œdrawing å°†ä½œä¸ºå‘½ä»¤åºåˆ—ä¿ç•™ã€‚PDF æ–‡ä»¶å’Œä½å›¾ä¹‹é—´å­˜åœ¨ä¸€äº›æ˜¾è‘—çš„å·®å¼‚ï¼š
  + ä¸ä½å›¾ä¸åŒï¼ŒPDFæ–‡ä»¶å¯èƒ½åŒ…å«å¤šä¸ª pageã€‚
  + ä»ä¸åŒè®¾å¤‡ä¸Šçš„ PDF æ–‡ä»¶ç»˜åˆ¶ page æ—¶ï¼Œç”Ÿæˆçš„å›¾åƒå°†é’ˆå¯¹è¯¥è®¾å¤‡çš„æ˜¾ç¤ºç‰¹æ€§è¿›è¡Œä¼˜åŒ–ã€‚
  + PDF æ–‡ä»¶æœ¬è´¨ä¸Šæ˜¯ç‹¬ç«‹äºåˆ†è¾¨ç‡çš„ï¼Œåœ¨ä¸ç‰ºç‰²å›¾åƒç»†èŠ‚çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥æ— é™åœ°å¢å¤§æˆ–å‡å°æ–‡ä»¶çš„å¤§å°ã€‚ç”¨æˆ·å¯¹ä½å›¾å›¾åƒçš„æ„ŸçŸ¥è´¨é‡ä¸è¦æŸ¥çœ‹ä½å›¾çš„åˆ†è¾¨ç‡æœ‰å…³ã€‚
è¯·å‚è§ Creating a PDF Graphics Contextã€‚

+ ï¼ˆwindow graphics contextï¼‰window å›¾å½¢ä¸Šä¸‹æ–‡æ˜¯å¯ç”¨äºç»˜åˆ¶åˆ°çª—å£ä¸­çš„å›¾å½¢ä¸Šä¸‹æ–‡ã€‚è¯·æ³¨æ„ï¼Œå› ä¸º Quartz 2D æ˜¯ä¸€ä¸ªå›¾å½¢å¼•æ“ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªçª—å£ç®¡ç†ç³»ç»Ÿï¼Œæ‰€ä»¥ä½ å¯ä»¥ä½¿ç”¨å…¶ä¸­ä¸€ä¸ªåº”ç”¨ç¨‹åºæ¡†æ¶æ¥è·å–çª—å£çš„å›¾å½¢ä¸Šä¸‹æ–‡ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§ Creating a Window Graphics Context in Mac OS X ã€‚

+ ï¼ˆlayer context ï¼‰å›¾å±‚ä¸Šä¸‹æ–‡ï¼ˆCGLayerRefï¼‰æ˜¯ä¸å…¶ä»–å›¾å½¢ä¸Šä¸‹æ–‡å…³è”çš„å±å¹•å¤–å›¾å½¢ç›®æ ‡ã€‚å®ƒçš„è®¾è®¡æ˜¯ä¸ºäº†åœ¨å°†å±‚ç»˜åˆ¶åˆ°åˆ›å»ºå®ƒçš„å›¾å½¢ä¸Šä¸‹æ–‡æ—¶è·å¾—æœ€ä½³æ€§èƒ½ã€‚å¯¹äºå±å¹•å¤–ç»˜åˆ¶ï¼Œå›¾å±‚ä¸Šä¸‹æ–‡å¯èƒ½æ¯”ä½å›¾å›¾å½¢ä¸Šä¸‹æ–‡æ›´å¥½ã€‚è¯·å‚è§ Core Graphics Layer Drawingã€‚

+ ï¼ˆPostScript graphics contextï¼‰å¦‚æœè¦åœ¨ Mac OS X ä¸­æ‰“å°ï¼Œåˆ™å°†å†…å®¹å‘é€åˆ°ç”±æ‰“å°æ¡†æ¶ç®¡ç†çš„ PostScript å›¾å½¢ä¸Šä¸‹æ–‡ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§ Obtaining a Graphics Context for Printingã€‚

### Quartz 2D Opaque Data Types
&emsp;é™¤äº†å›¾å½¢ä¸Šä¸‹æ–‡ä¹‹å¤–ï¼ŒQuartz 2D API è¿˜å®šä¹‰äº†å„ç§ä¸é€æ˜çš„æ•°æ®ç±»å‹ã€‚å› ä¸º API æ˜¯ Core Graphics æ¡†æ¶çš„ä¸€éƒ¨åˆ†ï¼Œæ‰€ä»¥å¯¹å…¶è¿›è¡Œæ“ä½œçš„æ•°æ®ç±»å‹å’Œä¾‹ç¨‹ä½¿ç”¨ CG å‰ç¼€ã€‚

&emsp;Quartz 2D ä»ä¸é€æ˜çš„æ•°æ®ç±»å‹åˆ›å»ºå¯¹è±¡ï¼Œåº”ç”¨ç¨‹åºå¯¹è¿™äº›æ•°æ®ç±»å‹è¿›è¡Œæ“ä½œä»¥å®ç°ç‰¹å®šçš„å›¾å½¢è¾“å‡ºã€‚å›¾ 1-3 æ˜¾ç¤ºäº†å°†ç»˜å›¾æ“ä½œåº”ç”¨äº Quartz 2D æä¾›çš„ä¸‰ä¸ªå¯¹è±¡æ—¶å¯ä»¥è·å¾—çš„å„ç§ç»“æœã€‚ä¾‹å¦‚ï¼š

+ é€šè¿‡åˆ›å»º PDF é¡µé¢å¯¹è±¡ï¼Œå¯¹å›¾å½¢ä¸Šä¸‹æ–‡åº”ç”¨æ—‹è½¬æ“ä½œï¼Œå¹¶è¦æ±‚ Quartz 2D å°†é¡µé¢ç»˜åˆ¶åˆ°å›¾å½¢ä¸Šä¸‹æ–‡ï¼Œå¯ä»¥æ—‹è½¬å’Œæ˜¾ç¤º PDF é¡µé¢ã€‚
+ å¯ä»¥é€šè¿‡åˆ›å»ºå›¾æ¡ˆå¯¹è±¡ã€å®šä¹‰æ„æˆå›¾æ¡ˆçš„å½¢çŠ¶ï¼Œä»¥åŠè®¾ç½® Quartz 2D ä»¥åœ¨å›¾æ¡ˆç»˜åˆ¶åˆ°å›¾å½¢ä¸Šä¸‹æ–‡æ—¶å°†å›¾æ¡ˆç”¨ä½œç»˜ç”»æ¥ç»˜åˆ¶å›¾æ¡ˆã€‚
+ é€šè¿‡åˆ›å»ºç€è‰²å¯¹è±¡ï¼Œæä¾›ç¡®å®šç€è‰²ä¸­æ¯ä¸ªç‚¹çš„é¢œè‰²çš„å‡½æ•°ï¼Œç„¶åè¦æ±‚ Quartz 2D å°†ç€è‰²ç”¨ä½œå¡«å……é¢œè‰²ï¼Œå¯ä»¥ä½¿ç”¨è½´å‘æˆ–å¾„å‘ç€è‰²å¡«å……åŒºåŸŸã€‚

&emsp;Figure 1-3  Opaque data types are the basis of drawing primitives in Quartz 2D

![drawing_primitives](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f2598ce6b52f4764aedf65690eb7302a~tplv-k3u1fbpfcp-watermark.image)

&emsp;Quartz 2D ä¸­å¯ç”¨çš„ä¸é€æ˜æ•°æ®ç±»å‹åŒ…æ‹¬ï¼š

+ CGPathRefï¼Œç”¨äºçŸ¢é‡å›¾å½¢ä»¥åˆ›å»ºå¡«å……æˆ–ç¬”åˆ’çš„è·¯å¾„ã€‚è¯·å‚è§ Pathsã€‚
+ CGImageRefï¼Œç”¨äºæ ¹æ®ä½ æä¾›çš„ç¤ºä¾‹æ•°æ®è¡¨ç¤ºä½å›¾å›¾åƒå’Œä½å›¾å›¾åƒæ©ç ã€‚è¯·å‚è§ Bitmap Images and Image Masksã€‚
+ CGLayerRefï¼Œç”¨äºè¡¨ç¤ºå¯ç”¨äºé‡å¤ç»˜åˆ¶ï¼ˆå¦‚èƒŒæ™¯æˆ–å›¾æ¡ˆï¼‰å’Œå±å¹•å¤–ç»˜åˆ¶çš„ç»˜å›¾å±‚ã€‚è¯·å‚è§ Core Graphics Layer Drawingã€‚
+ CGPatternRefï¼Œç”¨äºé‡å¤ç»˜åˆ¶ã€‚è¯·å‚è§ Patternsã€‚
+ CGShadingRef å’Œ CGGradientRefï¼Œç”¨äºç»˜åˆ¶æ¸å˜ã€‚è¯·å‚è§ Gradientsã€‚
+ CGFunctionRefï¼Œç”¨äºå®šä¹‰æ¥å—ä»»æ„æ•°é‡æµ®ç‚¹å‚æ•°çš„å›è°ƒå‡½æ•°ã€‚ä¸ºç€è‰²ï¼ˆshadingï¼‰åˆ›å»ºæ¸å˜ï¼ˆgradientsï¼‰æ—¶ï¼Œå°†ä½¿ç”¨æ­¤æ•°æ®ç±»å‹ã€‚è¯·å‚è§ Gradientsã€‚
+ CGColorRef å’Œ CGColorSpaceRefï¼Œç”¨æ¥å‘Šè¯‰ Quartz å¦‚ä½•è§£é‡Šé¢œè‰²ã€‚è¯·å‚è§ Color and Color Spacesã€‚
+ CGImageSourceRef å’Œ CGImageDestinationRefï¼Œç”¨äºå°†æ•°æ®ç§»å…¥å’Œç§»å‡º Quartzã€‚è¯·å‚è§ Data Management in Quartz 2D å’Œ Image I/O Programming Guideã€‚
+ CGFontRefï¼Œç”¨äºç»˜åˆ¶æ–‡æœ¬ã€‚è¯·å‚è§ Textã€‚
+ CGPDFDictionaryRefã€CGPDFObjectRefã€CGPDFPageRefã€CGPDFStreamã€CGPDFStringRef å’Œ CGPDFArrayRefï¼Œæä¾›å¯¹ PDF å…ƒæ•°æ®çš„è®¿é—®ã€‚è¯·å‚è§ PDF Document Creation, Viewing, and Transformingã€‚
+ CGPDFScannerRef å’Œ CGPDFContentStreamRefï¼Œç”¨äºè§£æ PDF å…ƒæ•°æ®ã€‚è¯·å‚è§ PDF Document Parsingã€‚
+ CGPSConverterRefï¼Œç”¨äºå°† PostScript è½¬æ¢ä¸º PDFã€‚å®ƒåœ¨ iOS ä¸­ä¸å¯ç”¨ã€‚è¯·å‚è§ PostScript Conversionã€‚

### Graphics States
&emsp;Quartz æ ¹æ®å½“å‰ graphics state ä¸­çš„å‚æ•°ä¿®æ”¹ç»˜å›¾æ“ä½œçš„ç»“æœã€‚graphics state åŒ…å«å‚æ•°ï¼Œå¦åˆ™è¿™äº›å‚æ•°å°†ä½œä¸ºç»˜å›¾ä¾‹ç¨‹ï¼ˆdrawing routinesï¼‰çš„å‚æ•°ã€‚ç»˜åˆ¶åˆ°å›¾å½¢ä¸Šä¸‹æ–‡çš„ä¾‹ç¨‹å‚è€ƒ graphics state ä»¥ç¡®å®šå¦‚ä½•å‘ˆç°å…¶ç»“æœã€‚ä¾‹å¦‚ï¼Œå½“ä½ è°ƒç”¨å‡½æ•°æ¥è®¾ç½®å¡«å……é¢œè‰²æ—¶ï¼Œä½ æ­£åœ¨ä¿®æ”¹å­˜å‚¨åœ¨å½“å‰ graphics state ä¸­çš„å€¼ã€‚å½“å‰ graphics state çš„å…¶ä»–å¸¸ç”¨å…ƒç´ åŒ…æ‹¬çº¿å®½ã€å½“å‰ä½ç½®å’Œæ–‡æœ¬å­—ä½“å¤§å°ã€‚

&emsp;graphics context åŒ…å«ä¸€å †ï¼ˆa stack ofï¼‰ graphics statesã€‚ï¼ˆåº”è¯¥ç¿»è¯‘ä¸º â€œå›¾å½¢ä¸Šä¸‹æ–‡åŒ…å«ä¸€ä¸ªå›¾å½¢çŠ¶æ€å †æ ˆâ€ï¼‰å½“ Quartz åˆ›å»ºå›¾å½¢ä¸Šä¸‹æ–‡æ—¶ï¼Œå †æ ˆä¸ºç©ºã€‚ä¿å­˜å›¾å½¢çŠ¶æ€æ—¶ï¼ŒQuartz ä¼šå°†å½“å‰å›¾å½¢çŠ¶æ€çš„å‰¯æœ¬æ¨å…¥åˆ°å †æ ˆä¸Šã€‚æ¢å¤å›¾å½¢çŠ¶æ€æ—¶ï¼ŒQuartz ä¼šå°†å›¾å½¢çŠ¶æ€ä»å †æ ˆé¡¶éƒ¨å¼¹å‡ºã€‚å¼¹å‡ºçŠ¶æ€å˜ä¸ºå½“å‰å›¾å½¢çŠ¶æ€ã€‚

&emsp;è¦ä¿å­˜å½“å‰å›¾å½¢çŠ¶æ€ï¼Œè¯·ä½¿ç”¨å‡½æ•° `CGContextSaveGState` å°†å½“å‰å›¾å½¢çŠ¶æ€çš„å‰¯æœ¬æ¨å…¥åˆ°å †æ ˆä¸Šã€‚è¦è¿˜åŸä»¥å‰ä¿å­˜çš„å›¾å½¢çŠ¶æ€ï¼Œè¯·ä½¿ç”¨å‡½æ•° `CGContextRestoreGState` å°†å½“å‰å›¾å½¢çŠ¶æ€æ›¿æ¢ä¸ºå †æ ˆé¡¶éƒ¨çš„å›¾å½¢çŠ¶æ€ã€‚

&emsp;è¯·æ³¨æ„ï¼Œå¹¶éå½“å‰ç»˜å›¾ç¯å¢ƒçš„æ‰€æœ‰ aspects éƒ½æ˜¯å›¾å½¢çŠ¶æ€çš„å…ƒç´ ã€‚ä¾‹å¦‚ï¼Œå½“å‰è·¯å¾„ä¸è¢«è§†ä¸ºå›¾å½¢çŠ¶æ€çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤åœ¨è°ƒç”¨å‡½æ•° `CGContextSaveGState` æ—¶ä¸ä¼šä¿å­˜ã€‚è°ƒç”¨æ­¤å‡½æ•°æ—¶ä¿å­˜çš„å›¾å½¢çŠ¶æ€å‚æ•°å¦‚è¡¨ 1-1 æ‰€ç¤ºã€‚

&emsp;Table 1-1  Parameters that are associated with the graphics stateï¼ˆä¸å›¾å½¢çŠ¶æ€å…³è”çš„å‚æ•°ï¼‰
| Parameters | Discussed in this chapter |
| --- | --- |
| Current transformation matrix (CTM) | Transforms |
| Clipping area | Paths |
| Line: width, join, cap, dash, miter limit | Paths |
| Accuracy of curve estimation (flatness) | Paths |
| Anti-aliasing setting | Graphics Contexts |
| Color: fill and stroke settings | Color and Color Spaces |
| Alpha value (transparency) | Color and Color Spaces |
| Rendering intent | Color and Color Spaces |
| Color space: fill and stroke settings | Color and Color Spaces |
| Text: font, font size, character spacing, text drawing mode | Text |
| Blend mode | Paths and Bitmap Images and Image Masks |

### Quartz 2D Coordinate Systems
&emsp;å¦‚å›¾ 1-4 æ‰€ç¤ºï¼Œåæ ‡ç³»å®šä¹‰äº†ç”¨äºè¡¨ç¤ºè¦åœ¨é¡µé¢ä¸Šç»˜åˆ¶çš„å¯¹è±¡çš„ä½ç½®å’Œå¤§å°çš„ä½ç½®èŒƒå›´ã€‚å¯ä»¥åœ¨ç”¨æˆ·ç©ºé—´åæ ‡ç³»æˆ–æ›´ç®€å•çš„ç”¨æˆ·ç©ºé—´ä¸­æŒ‡å®šå›¾å½¢çš„ä½ç½®å’Œå¤§å°ã€‚åæ ‡è¢«å®šä¹‰ä¸ºæµ®ç‚¹å€¼ã€‚

&emsp;Figure 1-4  The Quartz coordinate system

![quartz_coordinates](https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b454ea014df644feb3ca038f87927c5f~tplv-k3u1fbpfcp-watermark.image)

&emsp;ç”±äºä¸åŒçš„è®¾å¤‡å…·æœ‰ä¸åŒçš„åŸºæœ¬æˆåƒèƒ½åŠ›ï¼Œå› æ­¤å¿…é¡»ä»¥ç‹¬ç«‹äºè®¾å¤‡çš„æ–¹å¼å®šä¹‰å›¾å½¢çš„ä½ç½®å’Œå¤§å°ã€‚ä¾‹å¦‚ï¼Œå±å¹•æ˜¾ç¤ºè®¾å¤‡å¯ä»¥æ¯è‹±å¯¸æ˜¾ç¤ºä¸è¶…è¿‡ 96 ä¸ªåƒç´ ï¼Œè€Œæ‰“å°æœºå¯ä»¥æ¯è‹±å¯¸æ˜¾ç¤º 300 ä¸ªåƒç´ ã€‚å¦‚æœåœ¨è®¾å¤‡çº§åˆ«å®šä¹‰åæ ‡ç³»ï¼ˆåœ¨æœ¬ä¾‹ä¸­ä¸º 96 åƒç´ æˆ– 300 åƒç´ ï¼‰ï¼Œåˆ™åœ¨è¯¥ç©ºé—´ä¸­ç»˜åˆ¶çš„å¯¹è±¡æ— æ³•åœ¨å…¶ä»–è®¾å¤‡ä¸Šå¤åˆ¶ï¼ˆreproduced å¤åˆ¶ã€é‡ç°ã€å†ç‰ˆï¼‰ï¼Œè€Œä¸ä¼šäº§ç”Ÿå¯è§çš„å¤±çœŸã€‚å®ƒä»¬ä¼šæ˜¾å¾—å¤ªå¤§æˆ–å¤ªå°ã€‚

&emsp;Quartz é€šè¿‡ä½¿ç”¨ current transformation matrixï¼ˆCTMï¼‰å°†å•ç‹¬çš„åæ ‡ç³»ç”¨æˆ·ç©ºé—´æ˜ å°„åˆ°è¾“å‡ºè®¾å¤‡ç©ºé—´çš„åæ ‡ç³»æ¥å®ç°è®¾å¤‡ç‹¬ç«‹æ€§ã€‚çŸ©é˜µæ˜¯ç”¨æ¥æœ‰æ•ˆæè¿°ä¸€ç»„ç›¸å…³æ–¹ç¨‹çš„æ•°å­¦ç»“æ„ã€‚å½“å‰å˜æ¢çŸ©é˜µæ˜¯ä¸€ç§ç‰¹æ®Šç±»å‹çš„çŸ©é˜µï¼Œç§°ä¸ºä»¿å°„å˜æ¢ï¼Œå®ƒé€šè¿‡åº”ç”¨å¹³ç§»ã€æ—‹è½¬å’Œç¼©æ”¾æ“ä½œï¼ˆç§»åŠ¨ã€æ—‹è½¬å’Œè°ƒæ•´åæ ‡ç³»å¤§å°çš„è®¡ç®—ï¼‰å°†ç‚¹ä»ä¸€ä¸ªåæ ‡ç©ºé—´æ˜ å°„åˆ°å¦ä¸€ä¸ªåæ ‡ç©ºé—´ã€‚

&emsp;å½“å‰å˜æ¢çŸ©é˜µè¿˜æœ‰ä¸€ä¸ªæ¬¡è¦ç”¨é€”ï¼šå®ƒå…è®¸ä½ å˜æ¢å¯¹è±¡çš„ç»˜åˆ¶æ–¹å¼ã€‚ä¾‹å¦‚ï¼Œè¦ç»˜åˆ¶æ—‹è½¬ 45 åº¦çš„é•¿æ–¹ä½“ï¼Œè¯·å…ˆæ—‹è½¬é¡µé¢çš„åæ ‡ç³»ï¼ˆCTMï¼‰ï¼Œç„¶åå†ç»˜åˆ¶é•¿æ–¹ä½“ã€‚Quartz ä½¿ç”¨æ—‹è½¬åæ ‡ç³»ç»˜åˆ¶åˆ°è¾“å‡ºè®¾å¤‡ã€‚

&emsp;ç”¨æˆ·ç©ºé—´ä¸­çš„ç‚¹ç”±åæ ‡å¯¹ï¼ˆxï¼Œyï¼‰è¡¨ç¤ºï¼Œå…¶ä¸­ x è¡¨ç¤ºæ²¿æ°´å¹³è½´ï¼ˆå·¦å’Œå³ï¼‰çš„ä½ç½®ï¼Œy è¡¨ç¤ºå‚ç›´è½´ï¼ˆä¸Šå’Œä¸‹ï¼‰ã€‚ç”¨æˆ·åæ ‡ç©ºé—´çš„åŸç‚¹æ˜¯ç‚¹ï¼ˆ0,0ï¼‰ã€‚åŸç‚¹ä½äºé¡µé¢çš„å·¦ä¸‹è§’ï¼Œå¦‚å›¾ 1-4 æ‰€ç¤ºã€‚åœ¨ Quartz çš„é»˜è®¤åæ ‡ç³»ä¸­ï¼Œx è½´ä»é¡µé¢çš„å·¦ä¾§å‘å³ä¾§ç§»åŠ¨æ—¶ä¼šå¢åŠ ã€‚å½“ y è½´ä»é¡µé¢åº•éƒ¨å‘é¡¶éƒ¨ç§»åŠ¨æ—¶ï¼Œå…¶å€¼ä¼šå¢åŠ ã€‚

&emsp;ä¸€äº›æŠ€æœ¯ä½¿ç”¨ä¸åŒäº Quartz ä½¿ç”¨çš„é»˜è®¤åæ ‡ç³»æ¥è®¾ç½®å›¾å½¢ä¸Šä¸‹æ–‡ã€‚ç›¸å¯¹äº Quartzï¼Œè¿™ç§åæ ‡ç³»æ˜¯ä¸€ç§ä¿®æ”¹åçš„åæ ‡ç³»ï¼Œåœ¨æ‰§è¡ŒæŸäº› Quartz ç»˜å›¾æ“ä½œæ—¶å¿…é¡»è¿›è¡Œè¡¥å¿ã€‚æœ€å¸¸è§çš„ä¿®æ”¹åæ ‡ç³»å°†åŸç‚¹æ”¾ç½®åœ¨ä¸Šä¸‹æ–‡çš„å·¦ä¸Šè§’ï¼Œå¹¶å°† y è½´æ›´æ”¹ä¸ºæŒ‡å‘é¡µé¢åº•éƒ¨ã€‚ä½ å¯èƒ½ä¼šçœ‹åˆ°ä½¿ç”¨æ­¤ç‰¹å®šåæ ‡ç³»çš„å‡ ä¸ªåœ°æ–¹å¦‚ä¸‹æ‰€ç¤ºï¼š

+ åœ¨ Mac OS Xä¸­ï¼ŒNSView çš„å­ç±»é‡å†™å…¶ isFlipped æ–¹æ³•ä»¥è¿”å› YESã€‚
+ åœ¨ iOS ä¸­ï¼ŒUIView è¿”å›çš„ç»˜å›¾ä¸Šä¸‹æ–‡ã€‚
+ åœ¨ iOS ä¸­ï¼Œé€šè¿‡è°ƒç”¨ `UIGraphicsBeginImageContextWithOptions` å‡½æ•°åˆ›å»ºçš„å›¾å½¢ä¸Šä¸‹æ–‡ã€‚

&emsp;UIKit è¿”å›å…·æœ‰ä¿®æ”¹åæ ‡ç³»çš„ Quartz å›¾å½¢ä¸Šä¸‹æ–‡çš„åŸå› æ˜¯ UIKit ä½¿ç”¨ä¸åŒçš„é»˜è®¤åæ ‡çº¦å®šï¼›å®ƒå°†è½¬æ¢åº”ç”¨äºå®ƒåˆ›å»ºçš„ Quartz ä¸Šä¸‹æ–‡ï¼Œä»¥ä¾¿å®ƒä»¬ä¸å®ƒçš„çº¦å®šç›¸åŒ¹é…ã€‚å¦‚æœåº”ç”¨ç¨‹åºå¸Œæœ›ä½¿ç”¨ç›¸åŒçš„ç»˜å›¾ä¾‹ç¨‹ç»˜åˆ¶ UIView å¯¹è±¡å’Œ PDF å›¾å½¢ä¸Šä¸‹æ–‡ï¼ˆç”± Quartz åˆ›å»ºå¹¶ä½¿ç”¨é»˜è®¤åæ ‡ç³»ï¼‰ï¼Œåˆ™éœ€è¦åº”ç”¨å˜æ¢ï¼Œä»¥ä¾¿ PDF å›¾å½¢ä¸Šä¸‹æ–‡æ¥æ”¶ç›¸åŒçš„ä¿®æ”¹åæ ‡ç³»ã€‚ä¸ºæ­¤ï¼Œåº”ç”¨ä¸€ä¸ªè½¬æ¢ï¼Œå°†åŸç‚¹è½¬æ¢åˆ° PDF ä¸Šä¸‹æ–‡çš„å·¦ä¸Šè§’ï¼Œå¹¶å°† y åæ ‡ç¼©æ”¾ -1ï¼ˆåº”è¯¥æ˜¯ä¹˜ä»¥è´Ÿ 1ï¼‰ã€‚

&emsp;ä½¿ç”¨ç¼©æ”¾å˜æ¢æ¥æ¶ˆé™¤ y åæ ‡ä¼šæ”¹å˜ Quartz ç»˜å›¾ä¸­çš„ä¸€äº›çº¦å®šã€‚ä¾‹å¦‚ï¼Œå¦‚æœè°ƒç”¨ `CGContextDrawImage` å°†å›¾åƒç»˜åˆ¶åˆ°ä¸Šä¸‹æ–‡ä¸­ï¼Œåˆ™åœ¨å°†å›¾åƒç»˜åˆ¶åˆ°ç›®æ ‡ä¸­æ—¶ï¼Œè½¬æ¢ä¼šå¯¹å›¾åƒè¿›è¡Œä¿®æ”¹ã€‚ç±»ä¼¼åœ°ï¼Œè·¯å¾„ç»˜åˆ¶ä¾‹ç¨‹æ¥å—æŒ‡å®šåœ¨é»˜è®¤åæ ‡ç³»ä¸­æ˜¯é¡ºæ—¶é’ˆè¿˜æ˜¯é€†æ—¶é’ˆæ–¹å‘ç»˜åˆ¶åœ†å¼§çš„å‚æ•°ã€‚å¦‚æœä¿®æ”¹äº†åæ ‡ç³»ï¼Œç»“æœä¹Ÿä¼šè¢«ä¿®æ”¹ï¼Œå°±åƒå›¾åƒåœ¨é•œå­ä¸­åå°„ä¸€æ ·ã€‚åœ¨å›¾ 1-5 ä¸­ï¼Œå°†ç›¸åŒçš„å‚æ•°ä¼ é€’åˆ° Quartz ä¼šåœ¨é»˜è®¤åæ ‡ç³»ä¸­äº§ç”Ÿä¸€ä¸ªé¡ºæ—¶é’ˆçš„å¼§ï¼Œåœ¨ y åæ ‡è¢«å˜æ¢å–ååäº§ç”Ÿä¸€ä¸ªé€†æ—¶é’ˆçš„å¼§ã€‚

&emsp;Figure 1-5  Modifying the coordinate system creates a mirrored image.ï¼ˆä¿®æ”¹åæ ‡ç³»å°†åˆ›å»ºä¸€ä¸ªé•œåƒå›¾åƒã€‚ï¼‰

![flipped_coordinates](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c76ff5ca622143a9b28b038db19904c1~tplv-k3u1fbpfcp-watermark.image)

&emsp;ç”±ä½ çš„åº”ç”¨ç¨‹åºæ¥è°ƒæ•´å®ƒå¯¹åº”ç”¨äº†è½¬æ¢çš„ä¸Šä¸‹æ–‡æ‰€åšçš„ä»»ä½• Quartz è°ƒç”¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœå¸Œæœ›å›¾åƒæˆ– PDF æ­£ç¡®åœ°ç»˜åˆ¶åˆ°å›¾å½¢ä¸Šä¸‹æ–‡ä¸­ï¼Œåº”ç”¨ç¨‹åºå¯èƒ½éœ€è¦ä¸´æ—¶è°ƒæ•´å›¾å½¢ä¸Šä¸‹æ–‡çš„ CTMã€‚åœ¨ iOS ä¸­ï¼Œå¦‚æœä½¿ç”¨ UIImage å¯¹è±¡åŒ…è£…åˆ›å»ºçš„ CGImage å¯¹è±¡ï¼Œåˆ™ä¸éœ€è¦ä¿®æ”¹ CTMã€‚UIImage å¯¹è±¡è‡ªåŠ¨è¡¥å¿ UIKit åº”ç”¨çš„ä¿®æ”¹åçš„åæ ‡ç³»ã€‚

> Important: å¦‚æœä½ è®¡åˆ’åœ¨ iOS ä¸Šç›´æ¥é’ˆå¯¹ Quartz ç¼–å†™åº”ç”¨ç¨‹åºï¼Œé‚£ä¹ˆä¸Šé¢çš„è®¨è®ºå¯¹äºç†è§£è¿™ä¸€ç‚¹éå¸¸é‡è¦ï¼Œä½†è¿™è¿˜ä¸å¤Ÿã€‚åœ¨ iOS 3.2 åŠæ›´é«˜ç‰ˆæœ¬ä¸Šï¼Œå½“ UIKit ä¸ºåº”ç”¨ç¨‹åºåˆ›å»ºå›¾å½¢ä¸Šä¸‹æ–‡æ—¶ï¼Œå®ƒè¿˜ä¼šå¯¹ä¸Šä¸‹æ–‡è¿›è¡Œå…¶ä»–æ›´æ”¹ï¼Œä»¥åŒ¹é…é»˜è®¤çš„ UIKit çº¦å®šã€‚ç‰¹åˆ«æ˜¯ï¼Œä¸å— CTM å½±å“çš„æ¨¡å¼å’Œé˜´å½±å°†åˆ†åˆ«è¿›è¡Œè°ƒæ•´ï¼Œä»¥ä¾¿å®ƒä»¬çš„çº¦å®šä¸ UIKit çš„åæ ‡ç³»åŒ¹é…ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä½ çš„åº”ç”¨ç¨‹åºæ— æ³•ä½¿ç”¨ä¸ CTM ç­‰æ•ˆçš„æœºåˆ¶æ¥æ›´æ”¹ Quartz åˆ›å»ºçš„ä¸Šä¸‹æ–‡ï¼Œä»¥åŒ¹é… UIKit æä¾›çš„ä¸Šä¸‹æ–‡çš„è¡Œä¸ºï¼›ä½ çš„åº”ç”¨ç¨‹åºå¿…é¡»è¯†åˆ«å®ƒæ‰€å¼•å…¥çš„ä¸Šä¸‹æ–‡ç±»å‹ï¼Œå¹¶è°ƒæ•´å…¶è¡Œä¸ºä»¥åŒ¹é…ä¸Šä¸‹æ–‡çš„æœŸæœ›ã€‚

### Memory Management: Object Ownership
&emsp;Quartz ä½¿ç”¨ Core Foundation å†…å­˜ç®¡ç†æ¨¡å‹ï¼Œå…¶ä¸­å¯¹è±¡æ˜¯å¼•ç”¨è®¡æ•°çš„ã€‚åˆ›å»º Core Foundation å¯¹è±¡æ—¶ï¼Œå¼•ç”¨è®¡æ•°ä¸º 1ã€‚ä½ å¯ä»¥é€šè¿‡è°ƒç”¨å‡½æ•°æ¥ä¿ç•™å¯¹è±¡æ¥å¢åŠ å¼•ç”¨è®¡æ•°ï¼Œé€šè¿‡è°ƒç”¨å‡½æ•°æ¥é‡Šæ”¾å¯¹è±¡æ¥å‡å°‘å¼•ç”¨è®¡æ•°ã€‚å½“å¼•ç”¨è®¡æ•°å‡å°‘åˆ° 0 æ—¶ï¼Œå¯¹è±¡è¢«é‡Šæ”¾ã€‚æ­¤æ¨¡å‹å…è®¸å¯¹è±¡å®‰å…¨åœ°å…±äº«å¯¹å…¶ä»–å¯¹è±¡çš„å¼•ç”¨ã€‚

&emsp;éœ€è¦ç‰¢è®°ä¸€äº›ç®€å•çš„è§„åˆ™ï¼š

+ å¦‚æœä½ åˆ›å»ºæˆ–å¤åˆ¶ä¸€ä¸ªå¯¹è±¡ï¼Œä½ å°±æ‹¥æœ‰å®ƒï¼Œå› æ­¤ä½ å¿…é¡»é‡Šæ”¾å®ƒã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå¦‚æœä»åç§°ä¸­å¸¦æœ‰ â€œCreateâ€ æˆ– â€œCopyâ€ å­—æ ·çš„å‡½æ•°ä¸­è·å–å¯¹è±¡ï¼Œåˆ™å¿…é¡»åœ¨å¤„ç†å®Œè¯¥å¯¹è±¡åé‡Šæ”¾è¯¥å¯¹è±¡ã€‚å¦åˆ™ï¼Œä¼šå¯¼è‡´å†…å­˜æ³„æ¼ã€‚
+ å¦‚æœä»åç§°ä¸­ä¸åŒ…å«å•è¯ â€œCreateâ€ æˆ– â€œCopyâ€ çš„å‡½æ•°ä¸­è·å–å¯¹è±¡ï¼Œåˆ™ä¸æ‹¥æœ‰å¯¹è¯¥å¯¹è±¡çš„å¼•ç”¨ï¼Œå¹¶ä¸”ä¸èƒ½é‡Šæ”¾è¯¥å¯¹è±¡ã€‚è¯¥å¯¹è±¡å°†åœ¨å°†æ¥æŸä¸ªæ—¶å€™ç”±å…¶æ‰€æœ‰è€…é‡Šæ”¾ã€‚
+ å¦‚æœä½ ä¸æ‹¥æœ‰æŸä¸ªå¯¹è±¡å¹¶ä¸”éœ€è¦å°†å…¶ä¿ç•™åœ¨å‘¨å›´ï¼Œåˆ™å¿…é¡»ä¿ç•™è¯¥å¯¹è±¡ï¼Œå¹¶åœ¨å¤„ç†å®Œè¯¥å¯¹è±¡åå°†å…¶é‡Šæ”¾ã€‚å¯ä»¥ä½¿ç”¨ç‰¹å®šäºå¯¹è±¡çš„ Quartz 2D å‡½æ•°æ¥ä¿ç•™å’Œé‡Šæ”¾è¯¥å¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ”¶åˆ°å¯¹ CGColorspace å¯¹è±¡çš„å¼•ç”¨ï¼Œåˆ™å¯ä»¥ä½¿ç”¨å‡½æ•° `CGColorSpaceRetain` å’Œ `CGColorSpaceRelease` æ ¹æ®éœ€è¦ä¿ç•™å’Œé‡Šæ”¾è¯¥å¯¹è±¡ã€‚ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ Core Foundation  ç¡€å‡½æ•° `CFRetain` å’Œ `CFRelease`ï¼Œä½†å¿…é¡»æ³¨æ„ä¸è¦å°† NULL ä¼ é€’ç»™è¿™äº›å‡½æ•°ã€‚

## Graphics Contexts
&emsp;å›¾å½¢ä¸Šä¸‹æ–‡è¡¨ç¤ºç»˜å›¾ç›®æ ‡ã€‚å®ƒåŒ…å«ç»˜å›¾å‚æ•°å’Œç»˜å›¾ç³»ç»Ÿæ‰§è¡Œä»»ä½•åç»­ç»˜å›¾å‘½ä»¤æ‰€éœ€çš„æ‰€æœ‰è®¾å¤‡ç‰¹å®šä¿¡æ¯ã€‚å›¾å½¢ä¸Šä¸‹æ–‡å®šä¹‰åŸºæœ¬ç»˜å›¾å±æ€§ï¼Œä¾‹å¦‚ç»˜åˆ¶æ—¶è¦ä½¿ç”¨çš„é¢œè‰²ã€å‰ªè£åŒºåŸŸã€çº¿å®½å’Œæ ·å¼ä¿¡æ¯ã€å­—ä½“ä¿¡æ¯ã€åˆæˆé€‰é¡¹ä»¥åŠå…¶ä»–ä¸€äº›å±æ€§ã€‚

&emsp;ä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ Quartz ä¸Šä¸‹æ–‡åˆ›å»ºå‡½æ•°æˆ–ä½¿ç”¨ Mac OS X æ¡†æ¶æˆ– iOS ä¸­çš„ UIKit æ¡†æ¶æä¾›çš„æ›´é«˜çº§å‡½æ•°æ¥è·å–å›¾å½¢ä¸Šä¸‹æ–‡ã€‚Quartz ä¸ºå„ç§é£æ ¼çš„ Quartz å›¾å½¢ä¸Šä¸‹æ–‡æä¾›å‡½æ•°ï¼ŒåŒ…æ‹¬ä½å›¾å’Œ PDFï¼Œä½ å¯ä»¥ä½¿ç”¨å®ƒä»¬åˆ›å»ºè‡ªå®šä¹‰å†…å®¹ã€‚

&emsp;æœ¬ç« ä»‹ç»å¦‚ä½•ä¸ºå„ç§ç»˜å›¾ç›®æ ‡åˆ›å»ºå›¾å½¢ä¸Šä¸‹æ–‡ã€‚å›¾å½¢ä¸Šä¸‹æ–‡åœ¨ä»£ç ä¸­ç”±æ•°æ®ç±»å‹ CGContextRef è¡¨ç¤ºï¼ŒCGContextRef æ˜¯ä¸€ç§ä¸é€æ˜çš„æ•°æ®ç±»å‹ã€‚è·å–å›¾å½¢ä¸Šä¸‹æ–‡åï¼Œå¯ä»¥ä½¿ç”¨ Quartz 2D å‡½æ•°ç»˜åˆ¶åˆ°ä¸Šä¸‹æ–‡ï¼Œå¯¹ä¸Šä¸‹æ–‡æ‰§è¡Œæ“ä½œï¼ˆå¦‚è½¬æ¢ï¼‰ï¼Œå¹¶æ›´æ”¹å›¾å½¢çŠ¶æ€ï¼ˆgraphics stateï¼‰å‚æ•°ï¼Œå¦‚çº¿å®½å’Œå¡«å……é¢œè‰²ã€‚

### Drawing to a View Graphics Context in iOS
&emsp;è¦åœ¨ iOS åº”ç”¨ç¨‹åºä¸­ç»˜åˆ¶åˆ°å±å¹•ï¼Œéœ€è¦è®¾ç½® UIView å¯¹è±¡å¹¶å®ç°å…¶ `drawRect:` æ–¹æ³•æ¥æ‰§è¡Œç»˜åˆ¶ã€‚å½“è§†å›¾åœ¨å±å¹•ä¸Šå¯è§å¹¶ä¸”å…¶å†…å®¹éœ€è¦æ›´æ–°æ—¶ï¼Œå°†è°ƒç”¨è§†å›¾çš„ `drawRect:` æ–¹æ³•ã€‚åœ¨è°ƒç”¨è‡ªå®šä¹‰ `drawRect:` æ–¹æ³•ä¹‹å‰ï¼Œè§†å›¾å¯¹è±¡ä¼šè‡ªåŠ¨é…ç½®å…¶ç»˜å›¾ç¯å¢ƒï¼Œä»¥ä¾¿ä»£ç å¯ä»¥ç«‹å³å¼€å§‹ç»˜å›¾ã€‚ä½œä¸ºæ­¤é…ç½®çš„ä¸€éƒ¨åˆ†ï¼ŒUIView å¯¹è±¡ä¸ºå½“å‰å›¾å½¢ç¯å¢ƒåˆ›å»ºå›¾å½¢ä¸Šä¸‹æ–‡ï¼ˆCGContextRef ä¸é€æ˜ç±»å‹ï¼‰ã€‚é€šè¿‡è°ƒç”¨ UIKit å‡½æ•° `UIGraphicsGetCurrentContext`ï¼Œå¯ä»¥åœ¨ `drawRect:` æ–¹æ³•ä¸­è·å¾—æ­¤å›¾å½¢ä¸Šä¸‹æ–‡ã€‚

&emsp;æ•´ä¸ª UIKit ä½¿ç”¨çš„é»˜è®¤åæ ‡ç³»ä¸ Quartz ä½¿ç”¨çš„åæ ‡ç³»ä¸åŒã€‚åœ¨ UIKit ä¸­ï¼ŒåŸç‚¹ä½äºå·¦ä¸Šè§’ï¼Œæ­£ y å€¼å‘ä¸‹ã€‚UIView å¯¹è±¡é€šè¿‡å°†åŸç‚¹å¹³ç§»åˆ°è§†å›¾çš„å·¦ä¸Šè§’å¹¶å°† y è½´ä¹˜ä»¥ -1 æ¥åè½¬ y è½´ï¼Œä»è€Œä¿®æ”¹ Quartz å›¾å½¢ä¸Šä¸‹æ–‡çš„ CTM ä»¥åŒ¹é… UIKit çº¦å®šã€‚æœ‰å…³ä¿®æ”¹çš„åæ ‡ç³»ä»¥åŠç»˜å›¾ä»£ç ä¸­çš„å«ä¹‰çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§ Quartz 2D Coordinate Systemsã€‚

&emsp;UIView å¯¹è±¡çš„è¯¦ç»†æè¿°ä¿¡æ¯åœ¨ View Programming Guide for iOS ä¸­ã€‚

### Creating a Window Graphics Context in Mac OS X
&emsp;åœ¨ Mac OS X ä¸­ç»˜å›¾æ—¶ï¼Œéœ€è¦åˆ›å»ºä¸€ä¸ªé€‚åˆæ‰€ç”¨æ¡†æ¶çš„ window å›¾å½¢ä¸Šä¸‹æ–‡ã€‚Quartz 2D API æœ¬èº«ä¸æä¾›è·å– windows å›¾å½¢ä¸Šä¸‹æ–‡çš„å‡½æ•°ã€‚ç›¸åï¼Œä½ å¯ä»¥ä½¿ç”¨ Cocoa æ¡†æ¶æ¥è·å–åœ¨ Cocoa ä¸­åˆ›å»ºçš„çª—å£çš„ä¸Šä¸‹æ–‡ã€‚

&emsp;ä½ å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç ä» Cocoa åº”ç”¨ç¨‹åºçš„ `drawRect:` ä¾‹ç¨‹ä¸­è·å– Quartz å›¾å½¢ä¸Šä¸‹æ–‡ï¼š
```c++
CGContextRef myContext = [[NSGraphicsContext currentContext] graphicsPort];
```
&emsp;æ–¹æ³• `currentContext` è¿”å›å½“å‰çº¿ç¨‹çš„ NSGraphicsContext å®ä¾‹ã€‚`graphicsPort` æ–¹æ³•è¿”å› receiver è¡¨ç¤ºçš„ä½çº§åˆ«ã€ç‰¹å®šäºå¹³å°çš„å›¾å½¢ä¸Šä¸‹æ–‡ï¼Œè¿™æ˜¯ä¸€ä¸ª Quartz å›¾å½¢ä¸Šä¸‹æ–‡ã€‚ï¼ˆä¸è¦è¢«æ–¹æ³•åææ··äº†ï¼Œå®ƒä»¬æ˜¯å†å²çš„ã€‚ï¼‰æ›´å¤šä¿¡æ¯è¯·å‚è§ NSGraphicsContext Class Referenceã€‚

&emsp;è·å–å›¾å½¢ä¸Šä¸‹æ–‡åï¼Œå¯ä»¥åœ¨ Cocoa åº”ç”¨ç¨‹åºä¸­è°ƒç”¨ä»»ä½• Quartz 2D ç»˜å›¾å‡½æ•°ã€‚ä½ ä¹Ÿå¯ä»¥å°† Quartz 2D è°ƒç”¨ä¸ Cocoa ç»˜å›¾è°ƒç”¨æ··åˆä½¿ç”¨ã€‚å¦‚å›¾ 2-1 æ‰€ç¤ºï¼Œä½ å¯ä»¥çœ‹åˆ° Quartz 2D ç»˜åˆ¶åˆ° Cocoa è§†å›¾çš„ç¤ºä¾‹ã€‚è¯¥å›¾å½¢ç”±ä¸¤ä¸ªé‡å çš„çŸ©å½¢ç»„æˆï¼Œä¸€ä¸ªä¸é€æ˜çš„çº¢è‰²çŸ©å½¢å’Œä¸€ä¸ªéƒ¨åˆ†é€æ˜çš„è“è‰²çŸ©å½¢ã€‚ä½ å°†äº†è§£æœ‰å…³é¢œè‰²å’Œé¢œè‰²ç©ºé—´ä¸­é€æ˜åº¦çš„æ›´å¤šä¿¡æ¯ã€‚æ§åˆ¶å¤šå°‘é¢œè‰²å¯ä»¥ â€œé€è§†â€ é¢œè‰²çš„èƒ½åŠ›æ˜¯ Quartz 2D çš„æ ‡å¿—æ€§åŠŸèƒ½ä¹‹ä¸€ã€‚

&emsp;Figure 2-1  A view in the Cocoa framework that contains Quartz drawingï¼ˆCocoa æ¡†æ¶ä¸­åŒ…å« Quartz ç»˜å›¾çš„è§†å›¾ï¼‰

![cocoa_draw](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/45338667aba140b6a47ba655b68786cb~tplv-k3u1fbpfcp-watermark.image)

&emsp;è¦åˆ›å»ºå›¾ 2-1 ä¸­çš„å›¾å½¢ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ª Cocoa åº”ç”¨ç¨‹åº Xcode é¡¹ç›®ã€‚åœ¨ Interface Builder ä¸­ï¼Œå°†è‡ªå®šä¹‰è§†å›¾æ‹–åˆ°çª—å£ä¸­å¹¶å°†å…¶å­ç±»åŒ–ã€‚ç„¶åä¸ºå­ç±»è§†å›¾ç¼–å†™ä¸€ä¸ªå®ç°ï¼Œç±»ä¼¼äºæ¸…å• 2-1 æ‰€ç¤ºã€‚å¯¹äºæœ¬ä¾‹ï¼Œå­ç±»è§†å›¾å‘½åä¸º MyQuartzViewã€‚è§†å›¾çš„ `drawRect:` æ–¹æ³•åŒ…å«æ‰€æœ‰çš„ Quartz ç»˜å›¾ä»£ç ã€‚ä¸‹é¢åˆ—å‡ºäº†æ¯ä¸€è¡Œä»£ç çš„è¯¦ç»†è¯´æ˜ã€‚

> Note: æ¯æ¬¡éœ€è¦ç»˜åˆ¶è§†å›¾æ—¶ï¼Œéƒ½ä¼šè‡ªåŠ¨è°ƒç”¨ NSView ç±»çš„ `drawRect:` æ–¹æ³•ã€‚è¦äº†è§£æœ‰å…³é‡å†™ `drawRect:` æ–¹æ³•çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§ NSView Class Referenceã€‚

&emsp;Listing 2-1  Drawing to a window graphics context
```c++
@implementation MyQuartzView
 
- (id)initWithFrame:(NSRect)frameRect
{
    self = [super initWithFrame:frameRect];
    return self;
}
 
- (void)drawRect:(NSRect)rect
{
    CGContextRef myContext = [[NSGraphicsContext // 1
                                currentContext] graphicsPort];
                                
   // ********** Your drawing code here ********** // 2
    CGContextSetRGBFillColor (myContext, 1, 0, 0, 1);// 3
    CGContextFillRect (myContext, CGRectMake (0, 0, 200, 100 ));// 4
    CGContextSetRGBFillColor (myContext, 0, 0, 1, .5);// 5
    CGContextFillRect (myContext, CGRectMake (0, 0, 100, 200));// 6
  }
 
@end
```
&emsp;ä»£ç æ˜¯è¿™æ ·çš„ï¼š
1. è·å–è§†å›¾çš„å›¾å½¢ä¸Šä¸‹æ–‡ã€‚
2. åœ¨è¿™é‡Œæ’å…¥ç»˜å›¾ä»£ç ã€‚æ¥ä¸‹æ¥çš„å››è¡Œä»£ç æ˜¯ä½¿ç”¨ Quartz 2D å‡½æ•°çš„ç¤ºä¾‹ã€‚
3. è®¾ç½®å®Œå…¨ä¸é€æ˜çš„çº¢è‰²å¡«å……é¢œè‰²ã€‚æœ‰å…³é¢œè‰²å’Œ Alphaï¼ˆè®¾ç½®ä¸é€æ˜åº¦ï¼‰çš„ä¿¡æ¯ï¼Œè¯·å‚è§ Color and Color Spacesã€‚
4. å¡«å……ä¸€ä¸ªåŸç‚¹ä¸ºï¼ˆ0, 0ï¼‰ä¸”å®½åº¦ä¸º 200 ä¸”é«˜åº¦ä¸º 100 çš„çŸ©å½¢ã€‚æœ‰å…³ç»˜åˆ¶çŸ©å½¢çš„ä¿¡æ¯ï¼Œè¯·å‚è§ Pathsã€‚
5. è®¾ç½®éƒ¨åˆ†ä¸ºé€æ˜çš„è“è‰²å¡«å……é¢œè‰²ã€‚
6. å¡«å……ä¸€ä¸ªåŸç‚¹ä¸ºï¼ˆ0, 0ï¼‰ä¸”å®½åº¦ä¸º 100 ä¸”é«˜åº¦ä¸º 200 çš„çŸ©å½¢ã€‚

### Creating a PDF Graphics Context
&emsp;


When you create a PDF graphics context and draw to that context, Quartz records your drawing as a series of PDF drawing commands written to a file. You supply a location for the PDF output and a default media boxâ€”a rectangle that specifies bounds of the page. Figure 2-2 shows the result of drawing to a PDF graphics context and then opening the resulting PDF in Preview.

Figure 2-2  A PDF created by using CGPDFContextCreateWithURL


### Creating a Bitmap Graphics Context

#### Supported Pixel Formats

#### Anti-Aliasing

### Obtaining a Graphics Context for Printing











## å‚è€ƒé“¾æ¥
**å‚è€ƒé“¾æ¥:ğŸ”—**
+ [Quartz 2D Programming Guide](https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/Introduction/Introduction.html#//apple_ref/doc/uid/TP30001066)
+ [Core Graphics Framework Reference](https://developer.apple.com/documentation/coregraphics)
