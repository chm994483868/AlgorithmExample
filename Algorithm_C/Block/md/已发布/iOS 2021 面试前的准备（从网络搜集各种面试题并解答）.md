# iOS 2021 é¢è¯•å‰çš„å‡†å¤‡ï¼ˆä»ç½‘ç»œæœé›†å„ç§é¢è¯•é¢˜å¹¶è§£ç­”ï¼‰

> &emsp;åšä¸»å‰æœŸé€šè¯»äº† Apple çš„äº”ä»½æºç  [objc4-781](https://opensource.apple.com/tarballs/objc4/)ã€[libdispatch-1173.40.5](https://opensource.apple.com/tarballs/libdispatch/)ã€[CF-1151.16](https://opensource.apple.com/tarballs/CF/)ã€[libmalloc-283.100.6](https://opensource.apple.com/tarballs/libmalloc/)ã€[libclosure-74](https://opensource.apple.com/source/libclosure/) åŸºæœ¬å¯¹ iOS çš„å¤§éƒ¨åˆ†åº•å±‚åŸç†éƒ½æœ‰äº†ä¸€ä¸ªåŸºç¡€çš„è®¤çŸ¥ï¼Œç„¶åç®—æ³•éƒ¨åˆ†çš„è¯æ˜¯ä¸“æ³¨åˆ·äº†ä¸¤é ã€Šå‰‘æŒ‡ Offerã€‹ï¼ˆåœ¨ IDE é‡Œå¯ä»¥å®Œæˆé»˜å†™ï¼Œå®Œå…¨æ‰‹å†™çš„è¯å¯èƒ½è¿˜éœ€è¦ä¸€äº›ç»ƒä¹ ï¼‰ã€‚é‚£ä¹ˆæ—¢ç„¶æ˜¯é¢è¯•è‚¯å®šå…ä¸äº†è¦åˆ·é¢˜ï¼Œé¢˜ç›®çš„è¯å°±ä»ç½‘ç»œæœé›†å„ä½å¤§ä½¬é¢è¯•æ—¶çš„é¢˜ç›®ï¼Œç„¶åè¯•ç€ä»è‡ªå·±çš„ç†è§£ä¸Šç»™é¢˜ç›®ä½œå‡ºè§£ç­”ï¼Œå¦‚æœ‰é”™è¯¯çš„åœ°æ–¹è¿˜æœ›å¤§å®¶è¿›è¡ŒæŒ‡æ­£ã€‚   

1. KVC å’Œ KVO çš„å·¥ä½œåŸç†ã€‚ï¼ˆè¿½åŠ  KVO åŠ¨æ€ç”Ÿæˆçš„æ–°ç±»é‡å†™äº† Setter å‡½æ•°åï¼ŒåŸå§‹ Setter å‡½æ•°ä¼šæ€ä¹ˆæ ·ï¼Ÿå¯¹æŸä¸ªå¯¹è±¡æ·»åŠ  KVO åé‚£åŸå¯¹è±¡çš„ isa å’Œ class å‡½æ•°ä¼šå‘ç”Ÿä»€ä¹ˆå˜åŒ–ï¼Ÿï¼‰
&emsp;[iOSã€ŠKey-Value Coding Programming Guideã€‹å®˜æ–¹æ–‡æ¡£](https://juejin.cn/post/6915290445069156366) å’Œ [iOSã€ŠKey-Value Coding Programming Guideã€‹å®˜æ–¹æ–‡æ¡£](https://juejin.cn/post/6915290445069156366) è¿™ä¸¤ç¯‡æ˜¯ KVC å’Œ KVO å®˜æ–¹æ–‡æ¡£çš„ç¿»è¯‘ï¼Œå¦‚æœéœ€è¦çš„è¯å¯ä»¥è¿›è¡Œè¯¦ç»†é˜…è¯»ï¼Œä¸‹é¢å¯¹å®ƒä»¬çš„åŸç†è¿›è¡Œç®€è¦æ€»ç»“ã€‚



***

2. ä»€ä¹ˆæ˜¯ ARC ä»¥åŠ ARC çš„å·¥ä½œåŸç†ï¼ŒARC ä¸‹ä¼šå­˜åœ¨å†…å­˜æ³„æ¼å—ï¼Ÿ
&emsp;





1. iOS å±å¹•æˆåƒåŸç†ï¼ˆç¦»å±æ¸²æŸ“ Off-screen Renderedï¼‰ã€‚
2. atomicã€nonatomicã€strongï¼ˆretainï¼‰ã€weakï¼ˆunsafe_unretainedï¼‰ã€assign å±æ€§ä¿®é¥°ç¬¦çš„å·¥ä½œåŸç†ã€‚ï¼ˆ\_\_strongã€\_\_weakã€\_\_unsafe_unretainedï¼‰
3. weak åº•å±‚å®ç°åŸç†ã€‚
  + DisguisedPtr<objc_object> DisguisedPtr<objc_object *> ä¼ªè£…æŒ‡é’ˆï¼ŒæŠŠåœ°å€å˜ä¸ºæ•´æ•°ä¿å­˜ã€‚
  + typedef DisguisedPtr<objc_object *> weak_referrer_t; weak å˜é‡çš„åœ°å€ï¼Œå³ä¸€ä¸ªæŒ‡é’ˆçš„æŒ‡é’ˆã€‚
  + struct weak_entry_t ä¿å­˜æŸä¸ªå¯¹è±¡çš„æ‰€æœ‰ weak å˜é‡åœ°å€çš„å“ˆå¸Œè¡¨ã€‚
  + struct weak_table_t ä¿å­˜å¯¹è±¡å’Œå…¶ weak_entry_t çš„å“ˆå¸Œè¡¨ã€‚
  + struct SideTable æŸä¸ªå¯¹è±¡æ‰€å¤„çš„ SideTable è¡¨ï¼Œæœ‰ä¸‰ä¸ªæˆå‘˜å˜é‡ï¼šspinlock_t slockã€RefcountMap refcntsã€weak_table_t weak_tableã€‚
  + static StripedMap<SideTable>& SideTables ä¿å­˜ 8/64 å¼  SideTableï¼Œè·å–æŸä¸ªå¯¹è±¡æ‰€å¤„çš„ SideTableï¼šSideTable *table = &SideTables()[obj]ã€‚
  
  + å¯¹ weak_entry_t å’Œ weak_table_t çš„å“ˆå¸Œæ•°ç»„è¿›è¡Œæ“ä½œã€‚å­˜æ”¾ weak å˜é‡å’Œç§»é™¤ weak å˜é‡ã€weak å˜é‡ç½®ä¸º nil ç­‰æ“ä½œã€‚
  
  + objc_loadWeakRetainedã€objc_loadWeak weak å˜é‡è¯»å–ã€‚ï¼ˆobjc_copyWeakã€objc_moveWeakï¼‰
  
4. AssociatedObject åº•å±‚å®ç°åŸç†ã€‚class ObjcAssociation ç”¨äºä¿å­˜å…³è”ç­–ç•¥å’Œå…³è”å€¼ã€‚ObjectAssociationMap æ˜¯ key æ˜¯ const void *ï¼ˆç”¨äºæ ‡è¯†æŸä¸ªå…³è”å€¼çš„ keyï¼‰ï¼Œvalue æ˜¯ ObjcAssociation çš„å“ˆå¸Œè¡¨ã€‚AssociationsHashMap æ˜¯ key æ˜¯ DisguisedPtr<objc_object>ï¼Œvalue æ˜¯ ObjectAssociationMap çš„å“ˆå¸Œè¡¨ã€‚AssociationsManager æ˜¯ key æ˜¯ DisguisedPtr<objc_object>ï¼Œvalue æ˜¯ ObjectAssociationMap çš„å“ˆå¸Œè¡¨ã€‚
5. Category åº•å±‚å®ç°åŸç†ã€‚æ¦‚å¿µä¸æ•°æ®ç»“æ„ï¼šcategory_tã€‚è¿½åŠ  attachListsã€methodizeClassï¼Œå…ˆç¼–è¯‘çš„å…ˆè¿½åŠ ï¼Œæ—§å‡½æ•°å‘åç§»åŠ¨ï¼Œæ–°å‡½æ•°ä»å¤´å¼€å§‹è¿½åŠ ï¼Œæ‰€ä»¥åç¼–è¯‘çš„ category ä¼šè¿½åŠ åˆ°åˆ—è¡¨çš„æœ€å‰é¢å»ã€‚+ load å‡½æ•°æ‰§è¡Œã€‚
6. TaggedPointer çŸ¥è¯†ç‚¹ã€‚





## å‚è€ƒé“¾æ¥
**å‚è€ƒé“¾æ¥:ğŸ”—**
+ [NSCoding](https://developer.apple.com/library/archive/documentation/LegacyTechnologies/WebObjects/WebObjects_3.5/Reference/Frameworks/ObjC/Foundation/Protocols/NSCoding/Description.html#//apple_ref/occ/intf/NSCoding)


1. éŸ³è§†é¢‘å¤„ç†æ–¹å‘ã€‚
2. ç¼–è¯‘åŸç†ï¼Œé˜…è¯»ã€Šç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»ã€‹ã€‚
3. å¤ä¹ ã€ç®—æ³•ã€è®¡ç®—æœºç½‘ç»œã€‚

## 58åŒåŸé¢è¯•é¢˜
1. ç®€å•çš„è‡ªæˆ‘ä»‹ç»ã€‚
2. ä»‹ç» http å’Œ httpsã€‚
3. TCP å’Œ UDP çš„åŒºåˆ«ã€‚
4. KVC å’Œ KVO çš„åŸç†ä»¥åŠè¿½é—® KVO é‡å†™ Setter å‡½æ•°ååŸå§‹ Setter å‡½æ•°ä¼šæ€ä¹ˆæ ·ã€‚
5. VC çš„ç”Ÿå‘½å‘¨æœŸã€‚
6. viewDidLoad å‡½æ•°ä¸­åˆ›å»ºçš„ä¸€ä¸ªå±€éƒ¨ OC å˜é‡ä»€ä¹ˆæ—¶å€™é”€æ¯ã€‚
7. æ€ä¹ˆåŒºåˆ†å †åŒºå’Œæ ˆåŒºã€‚
8. block çš„åˆ†ç±»ã€‚
9. runloop çš„å·¥ä½œåŸç†ã€‚
10. runtime çš„æ¶ˆæ¯å‘é€æµç¨‹ã€‚runtime çš„å¸¸ç”¨åœºæ™¯ã€‚
11. UIView å’Œ CALayer çš„å…³ç³»ã€‚
12. CoreAnimation å®ç°åŠ¨ç”»ã€‚
13. CoreML çš„ä½¿ç”¨ã€‚
14. è·¨å¹³å°çš„ä½¿ç”¨ã€‚
15. æ•°æ®åº“çš„ä½¿ç”¨ä»¥åŠå¤šè¡¨è¿æŸ¥ç±»ä¼¼çš„ç›¸å…³çš„å†…å®¹ã€‚
16. è§†é¢‘ç¼“å­˜æœºåˆ¶ã€‚
17. è§£é‡Šå¤šçº¿ç¨‹ï¼Œçº¿ç¨‹å’Œé˜Ÿåˆ—çš„å…³ç³»ã€‚
18. iOS 10 å‰åçš„æ¨é€å°è£…ã€‚
19. æ–­ç‚¹ç»­ä¼ çš„å®ç°ã€‚
20. é€†å‘æœ‰æ²¡æœ‰äº†è§£è¿‡ã€‚
21. å®šæ—¶å™¨ dispatch_source å’Œ NSTimerï¼ŒNSTimer ä¸ºä»€ä¹ˆç²¾åº¦ä½ã€‚


1. æ–æ³¢é‚£å¥‘æ•°åˆ—ç®—æ³•
2. äºŒå‰æ ‘çš„æ·±åº¦å’Œå¹¿åº¦éå†
3. 50000ä¸ªæ•°ä¸­å‰ 5 ä¸ªå¤§çš„æ•°
4. äºŒå‰æ ‘çš„éé€’å½’å‰åºéå†


1. åŒæ­¥å’Œå¼‚æ­¥çš„åŒºåˆ«ï¼Œä»¥åŠå®ƒä»¬çš„å„è‡ªçš„ä½¿ç”¨åœºæ™¯ã€‚
2. ä»€ä¹ˆæ˜¯å•ä¾‹æ¨¡å¼ï¼ŸObjective-C å’Œ Swift ä¸‹åˆ†åˆ«æ˜¯æ€ä¹ˆå®ç°çš„ã€‚

3. ä»€ä¹ˆæ˜¯ ARC ä»¥åŠ ARC çš„å·¥ä½œåŸç†ï¼ŒARC ä¸‹ä¼šå­˜åœ¨å†…å­˜æ³„æ¼å—ï¼Ÿ
ç­”ï¼šARC æ˜¯ç”±ç¼–è¯‘å™¨å’Œ runtime åä½œçš„ç»“æœã€‚ARC ä¸­ç¦æ­¢æ‰‹åŠ¨è°ƒç”¨ retain/release/retainCount/dealloc(dealloc å¯é‡å†™ï¼Œä½†æ˜¯ä¸èƒ½æ˜¾ç¤ºè°ƒç”¨) æ–¹æ³•ã€‚å½“æˆ‘ä»¬ç¼–è¯‘æºç æ—¶ï¼Œç¼–è¯‘å™¨ä¼šåˆ†ææºç ä¸­æ¯ä¸ªå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œç„¶ååŸºäºè¿™äº›å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œæ¥æ·»åŠ ç›¸åº”çš„å¼•ç”¨è®¡æ•°æ“ä½œä»£ç ã€‚ARC ä¸­æ–°å¢äº† weak/strong å…³é”®å±æ€§å…³é”®å­—ã€‚

4. å¦‚ä½•æœ€å¤§é™åº¦çš„ä¿è¯ TableView çš„æ»‘åŠ¨æµç•…åº¦ã€‚
5. å¦‚ä½•å®ç°æ¨ªç«–å±ä¸‹çš„ä¸‰ç­‰åˆ†çº¦æŸã€‚
