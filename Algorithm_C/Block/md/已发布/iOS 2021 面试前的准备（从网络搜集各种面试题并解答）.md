# iOS 2021 面试前的准备（从网络搜集各种面试题并解答）

> &emsp;前期基本通读了 Apple 的五份源码 [objc4-781](https://opensource.apple.com/tarballs/objc4/)、[libdispatch-1173.40.5](https://opensource.apple.com/tarballs/libdispatch/)、[CF-1151.16](https://opensource.apple.com/tarballs/CF/)、[libmalloc-283.100.6](https://opensource.apple.com/tarballs/libmalloc/)、[libclosure-74](https://opensource.apple.com/source/libclosure/) 基本对 iOS 的大部分底层原理都有了一个基础的认知，然后算法部分的话是专注刷了两遍 《剑指 Offer》（在 IDE 里可以完成默写，完全手写的话可能还需要一些练习）。那么既然是面试肯定免不了要刷题，题目的话就从网络搜集各位大佬面试时的题目，然后试着从自己的理解上给题目作出解答，如有错误的地方还望大家进行指正。   

1. iOS 屏幕成像原理（离屏渲染 Off-screen Rendered）。
2. atomic、nonatomic、strong（retain）、weak（unsafe_unretained）、assign 属性修饰符的工作原理。（\_\_strong、\_\_weak、\_\_unsafe_unretained）
3. weak 底层实现原理。
  + DisguisedPtr<objc_object> DisguisedPtr<objc_object *> 伪装指针，把地址变为整数保存。
  + typedef DisguisedPtr<objc_object *> weak_referrer_t; weak 变量的地址，即一个指针的指针。
  + struct weak_entry_t 保存某个对象的所有 weak 变量地址的哈希表。
  + struct weak_table_t 保存对象和其 weak_entry_t 的哈希表。
  + struct SideTable 某个对象所处的 SideTable 表，有三个成员变量：spinlock_t slock、RefcountMap refcnts、weak_table_t weak_table。
  + static StripedMap<SideTable>& SideTables 保存 8/64 张 SideTable，获取某个对象所处的 SideTable：SideTable *table = &SideTables()[obj]。
  
  + 对 weak_entry_t 和 weak_table_t 的哈希数组进行操作。存放 weak 变量和移除 weak 变量、weak 变量置为 nil 等操作。
  
  + objc_loadWeakRetained、objc_loadWeak weak 变量读取。（objc_copyWeak、objc_moveWeak）
  
4. AssociatedObject 底层实现原理。class ObjcAssociation 用于保存关联策略和关联值。ObjectAssociationMap 是 key 是 const void *（用于标识某个关联值的 key），value 是 ObjcAssociation 的哈希表。AssociationsHashMap 是 key 是 DisguisedPtr<objc_object>，value 是 ObjectAssociationMap 的哈希表。AssociationsManager 是 key 是 DisguisedPtr<objc_object>，value 是 ObjectAssociationMap 的哈希表。
5. Category 底层实现原理。概念与数据结构：category_t






## 参考链接
**参考链接:🔗**
+ [NSCoding](https://developer.apple.com/library/archive/documentation/LegacyTechnologies/WebObjects/WebObjects_3.5/Reference/Frameworks/ObjC/Foundation/Protocols/NSCoding/Description.html#//apple_ref/occ/intf/NSCoding)
