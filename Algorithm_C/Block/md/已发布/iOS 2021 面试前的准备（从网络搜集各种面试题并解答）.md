# iOS 2021 面试前的准备（从网络搜集各种面试题并解答）

> &emsp;博主前期通读了 Apple 的五份源码 [objc4-781](https://opensource.apple.com/tarballs/objc4/)、[libdispatch-1173.40.5](https://opensource.apple.com/tarballs/libdispatch/)、[CF-1151.16](https://opensource.apple.com/tarballs/CF/)、[libmalloc-283.100.6](https://opensource.apple.com/tarballs/libmalloc/)、[libclosure-74](https://opensource.apple.com/source/libclosure/) 基本对 iOS 的大部分底层原理都有了一个基础的认知，然后算法部分的话是专注刷了两遍 《剑指 Offer》（在 IDE 里可以完成默写，完全手写的话可能还需要一些练习）。那么既然是面试肯定免不了要刷题，题目的话就从网络搜集各位大佬面试时的题目，然后试着从自己的理解上给题目作出解答，如有错误的地方还望大家进行指正。   

1. KVC 和 KVO 的工作原理。（追加 KVO 动态生成的新类重写了 Setter 函数后，原始 Setter 函数会怎么样？对某个对象添加 KVO 后那原对象的 isa 和 class 函数会发生什么变化？）
&emsp;[iOS《Key-Value Coding Programming Guide》官方文档](https://juejin.cn/post/6915290445069156366) 和 [iOS《Key-Value Coding Programming Guide》官方文档](https://juejin.cn/post/6915290445069156366) 这两篇是 KVC 和 KVO 官方文档的翻译，如果需要的话可以进行详细阅读，下面对它们的原理进行简要总结。



***

2. 什么是 ARC 以及 ARC 的工作原理，ARC 下会存在内存泄漏吗？
&emsp;





1. iOS 屏幕成像原理（离屏渲染 Off-screen Rendered）。
2. atomic、nonatomic、strong（retain）、weak（unsafe_unretained）、assign 属性修饰符的工作原理。（\_\_strong、\_\_weak、\_\_unsafe_unretained）
3. weak 底层实现原理。
  + DisguisedPtr<objc_object> DisguisedPtr<objc_object *> 伪装指针，把地址变为整数保存。
  + typedef DisguisedPtr<objc_object *> weak_referrer_t; weak 变量的地址，即一个指针的指针。
  + struct weak_entry_t 保存某个对象的所有 weak 变量地址的哈希表。
  + struct weak_table_t 保存对象和其 weak_entry_t 的哈希表。
  + struct SideTable 某个对象所处的 SideTable 表，有三个成员变量：spinlock_t slock、RefcountMap refcnts、weak_table_t weak_table。
  + static StripedMap<SideTable>& SideTables 保存 8/64 张 SideTable，获取某个对象所处的 SideTable：SideTable *table = &SideTables()[obj]。
  
  + 对 weak_entry_t 和 weak_table_t 的哈希数组进行操作。存放 weak 变量和移除 weak 变量、weak 变量置为 nil 等操作。
  
  + objc_loadWeakRetained、objc_loadWeak weak 变量读取。（objc_copyWeak、objc_moveWeak）
  
4. AssociatedObject 底层实现原理。class ObjcAssociation 用于保存关联策略和关联值。ObjectAssociationMap 是 key 是 const void *（用于标识某个关联值的 key），value 是 ObjcAssociation 的哈希表。AssociationsHashMap 是 key 是 DisguisedPtr<objc_object>，value 是 ObjectAssociationMap 的哈希表。AssociationsManager 是 key 是 DisguisedPtr<objc_object>，value 是 ObjectAssociationMap 的哈希表。
5. Category 底层实现原理。概念与数据结构：category_t。追加 attachLists、methodizeClass，先编译的先追加，旧函数向后移动，新函数从头开始追加，所以后编译的 category 会追加到列表的最前面去。+ load 函数执行。
6. TaggedPointer 知识点。





## 参考链接
**参考链接:🔗**
+ [NSCoding](https://developer.apple.com/library/archive/documentation/LegacyTechnologies/WebObjects/WebObjects_3.5/Reference/Frameworks/ObjC/Foundation/Protocols/NSCoding/Description.html#//apple_ref/occ/intf/NSCoding)


1. 音视频处理方向。
2. 编译原理，阅读《程序员的自我修养》。
3. 复习、算法、计算机网络。

## 58同城面试题
1. 简单的自我介绍。
2. 介绍 http 和 https。
3. TCP 和 UDP 的区别。
4. KVC 和 KVO 的原理以及追问 KVO 重写 Setter 函数后原始 Setter 函数会怎么样。
5. VC 的生命周期。
6. viewDidLoad 函数中创建的一个局部 OC 变量什么时候销毁。
7. 怎么区分堆区和栈区。
8. block 的分类。
9. runloop 的工作原理。
10. runtime 的消息发送流程。runtime 的常用场景。
11. UIView 和 CALayer 的关系。
12. CoreAnimation 实现动画。
13. CoreML 的使用。
14. 跨平台的使用。
15. 数据库的使用以及多表连查类似的相关的内容。
16. 视频缓存机制。
17. 解释多线程，线程和队列的关系。
18. iOS 10 前后的推送封装。
19. 断点续传的实现。
20. 逆向有没有了解过。
21. 定时器 dispatch_source 和 NSTimer，NSTimer 为什么精度低。


1. 斐波那契数列算法
2. 二叉树的深度和广度遍历
3. 50000个数中前 5 个大的数
4. 二叉树的非递归前序遍历


1. 同步和异步的区别，以及它们的各自的使用场景。
2. 什么是单例模式？Objective-C 和 Swift 下分别是怎么实现的。

3. 什么是 ARC 以及 ARC 的工作原理，ARC 下会存在内存泄漏吗？
答：ARC 是由编译器和 runtime 协作的结果。ARC 中禁止手动调用 retain/release/retainCount/dealloc(dealloc 可重写，但是不能显示调用) 方法。当我们编译源码时，编译器会分析源码中每个对象的生命周期，然后基于这些对象的生命周期，来添加相应的引用计数操作代码。ARC 中新增了 weak/strong 关键属性关键字。

4. 如何最大限度的保证 TableView 的滑动流畅度。
5. 如何实现横竖屏下的三等分约束。
